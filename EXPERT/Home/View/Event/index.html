<extend name="EXPERT/Templates/nav.html"/>
<block name="content">
    <div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">添加科技事件信息</h4>
                </div>

                <div class="modal-body">
                    <form class="form-horizontal" action="__URL__/add" method="post">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">开始时间</label>
                            <div class="col-sm-9">
                                <input type="text" name="time_start" class="form-control"  placeholder="时间格式：2010-10-10" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">结束时间</label>
                            <div class="col-sm-9">
                                <input type="text" name="time_end" class="form-control"  placeholder="时间格式：2010-10-10" >
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">名称</label>
                            <div class="col-sm-9">
                                <input type="text" name="name" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">简介</label>
                            <div class="col-sm-9">
                                <input type="text" name="abstract" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">相关人员</label>
                            <div class="col-sm-9">
                                <input type="text" name="relevant_person" class="form-control" >
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">地址</label>
                            <div class="col-sm-9">
                                <input type="text" name="location" class="form-control" >
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">备注</label>
                            <div class="col-sm-9">
                                <input type="text" name="remark" class="form-control" >
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">请选择上传图片</label>
                            <div class="col-sm-9">
                                <input name="imgfile" type="file" accept="image/gif, image/jpeg"/>

                                <input name="upload" type="submit" value="上传" />

                            </div>

                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-5">
                                <button type="submit" class="btn btn-info">确认</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="modal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModal2Label">修改科技事件信息</h4>
                </div>
                <!--<?php

                if (isset($_FILES['imgfile'])

                && is_uploaded_file($_FILES['imgfile']['tmp_name']))

                {

                 $imgFile = $_FILES['imgfile'];

                $upErr = $imgFile['error'];



                if ($upErr == 0)

                {

                $imgType = $imgFile['type']; //文件类型。



                /* 判断文件类型，这个例子里仅支持jpg和gif类型的图片文件。*/

                if ($imgType == 'image/jpeg'

                || $imgType == 'image/gif')

                {

                $imgFileName = $imgFile['name'];

                $imgSize = $imgFile['size'];

                $imgTmpFile = $imgFile['tmp_name'];



                /* 将文件从临时文件夹移到上传文件夹中。*/

                move_uploaded_file($imgTmpFile, 'upfile/'.$imgFileName);


                /*显示上传后的文件的信息。*/

                $strPrompt = sprintf("文件%s上传成功<br>"

                                , "文件大小: %s字节<br>"

                                , "<img src='upfile/%s'>"

                                , $imgFileName, $imgSize, $imgFileName

                                );

                                echo $strPrompt;

                                }

                                else

                                {

                                echo "请选择jpg或gif文件，不支持其它类型的文件。";

                                }

                                }

                                else

                                {

                                echo "文件上传失败。<br>";

                                switch ($upErr)

                                {

                                case 1:

                                echo "超过了php.ini中设置的上传文件大小。";

                                break;

                                case 2:

                                echo "超过了MAX_FILE_SIZE选项指定的文件大小。";

                                break;

                                case 3:

                                echo "文件只有部分被上传。";

                                break;

                                case 4:

                                echo "文件未被上传。";

                                break;

                                case 5:

                                echo "上传文件大小为0";

                                break;

                                }

                                }

                                }

                                else

                                {

                                /*显示表单。*/

                                ?>-->

                <div class="modal-body">
                    <form class="form-horizontal" action="__URL__/add" method="post">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">开始时间</label>
                            <div class="col-sm-9">
                                <input type="text" name="time_start" class="form-control"  placeholder="<?php echo $_GET['time_start']?>" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">结束时间</label>
                            <div class="col-sm-9">
                                <input type="text" name="time_end" class="form-control"  placeholder="<?php echo $_SESSION['time_end']?>" required/>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">名称</label>
                            <div class="col-sm-9">
                                <input type="email" name="name" class="form-control"  placeholder="<?php echo $_SESSION['name']?>" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">简介</label>
                            <div class="col-sm-9">
                                <input type="text" name="abstract" class="form-control" placeholder="<?php echo $_SESSION['abstract']?>" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">相关人员</label>
                            <div class="col-sm-9">
                                <input type="text" name="relevant_person" class="form-control" placeholder="<?php echo $_SESSION['relevant_person']?>" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">地址</label>
                            <div class="col-sm-9">
                                <input type="text" name="location" class="form-control" placeholder="<?php echo $_SESSION['location']?>" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">备注</label>
                            <div class="col-sm-9">
                                <input type="text" name="remark" class="form-control" placeholder="<?php echo $_SESSION['remark']?>" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">请选择上传图片</label>
                            <div class="col-sm-9">
                                <input name="imgfile" type="file" accept="image/gif, image/jpeg"/>

                                <input name="upload" type="submit" value="上传" />

                            </div>

                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-5">
                                <button type="submit" class="btn btn-info">确认</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                            </div>
                        </div>
                    </form>
                </div>




                <!--<?php
                }
                ?>-->

            </div>
        </div>
    </div>


    <div class="container" ng-app="event" ng-controller="eventController as vm">
        <div  id="pannel_frame" class="col-md-12">
            <div class="panel panel-default table-header">
                <div class="panel-heading table-heading">
                    <div class="row">
                        <div class="col-md-4 pull-left">
                            <h3 class="panel-title table-title">科技事件列表</h3>
                        </div>
                        <!--<div class="col-md-8 pull-right" ng-hide="vm.showCheckbox" ng-cloak>-->


                            <!--<button type="button" class="btn btn-info pull-right" data-toggle="modal" data-target="#modal">新增-->
                                <!--&nbsp;&nbsp;<span class="glyphicon glyphicon-plus"></span></button>&nbsp;&nbsp;&nbsp;-->
                        <!--<?php if($_SESSION['role_num']==2){ ?>-->
                        <!--<button type="button" class="btn btn-info pull-right right-10" ng-click="vm.showImportbox=true">-->
                            <!--导入Excel&nbsp;&nbsp;-->
                            <!--<span class="glyphicon glyphicon-import"></span>-->
                        <!--</button>-->
                        <!--<?php } ?>-->
                            <!--<button type="button" class="btn btn-info pull-right right-10" ng-click="vm.showCheckbox=true">导出Excel-->
                                <!--&nbsp;&nbsp;<span class="glyphicon glyphicon-export"></span></button>&nbsp;&nbsp;&nbsp;-->

                        <!--</div>-->
                    </div>
                </div>
                <!--<div class="col-md-8" ng-show="vm.showImportbox" ng-cloak>-->
                    <!--<form method="post" action="{:U('Event/import')}" enctype="multipart/form-data">-->
                        <!--&lt;!&ndash;<div class="col-sm-6">&ndash;&gt;-->
                        <!--&lt;!&ndash;<label class="pull-right right-10">浏览要导入的Excel文件：</label>&ndash;&gt;-->
                        <!--&lt;!&ndash;</div>&ndash;&gt;-->
                        <!--<div class="col-sm-8">-->
                            <!--<input type="file" class="pull-right bottom-10" name="file_import"/>-->
                        <!--</div>-->
                        <!--<div class="col-sm-4" class="pull-right right-10">-->
                            <!--<button class="btn btn-default pull-right right-10" type="button"-->
                                    <!--ng-click="vm.showImportbox=false">取消导入-->
                            <!--</button>-->
                            <!--<input type="submit" ng-click="vm.isUploading=true" class="btn btn-primary pull-right right-10" value="导入所选文件"/>-->
                        <!--</div>-->
                    <!--</form>-->
                <!--</div>-->
                <!--<div class="alert alert-danger col-md-12 top-5" style="margin-bottom: 2px;margin-top: 2px;text-align:center" ng-show="vm.isUploading && vm.showImportbox" ng-cloak>-->
                    <!--我们的服务器正在奋力导入您选择的数据，请您不妨喝杯咖啡耐心等待一下-->
                <!--</div>-->
            </div>
            <table class="table table-bordered table-striped table-hover">
                <thead>
                <tr>
                    <th width="4%">#</th>
                    <th width="20%">名称</th>
                    <th width="10%">时间</th>
                    <th width="20%">相关人员</th>
                    <th width="30%">简介</th>
                    <th width="16%">操作</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-if="vm.paginationConf.totalItems>0" ng-repeat="item in vm.eventList | filter:filter">
                    <td ng-bind="vm.baseIndex+$index+1"></td>
                    <td ng-bind="item.name"></td>
                    <td ng-bind="item.time_start"></td>
                    <td ng-bind="item.relevant_person"></td>
                    <td ng-bind="item.abstract"></td>
                    <td  style="white-space: nowrap;"><a href="#">详情</a><a href="__URL__/delete?id={{item.id}}" >删除</a></td>
                </tr>
                <tr ng-if="vm.paginationConf.totalItems==0"><td colspan="5"><h2 class="text-center text-danger">无数据</h2></td></tr>
                </tbody>
            </table>
            <tm-pagination conf="vm.paginationConf"></tm-pagination>
        </div>
    </div>
</block>
<block name="js">
    <script type="text/javascript" src="__PUBLIC__/js/event.controller.js"></script>
    <script type="text/javascript" src="__CDN__/angular-ui-bootstrap/0.14.3/ui-bootstrap.min.js"></script>
    <script>
        selectMenu('event',6, 0);
        $(document).ready(function(){
            refresh_mychart();
        });
        $(window).resize(refresh_mychart());
        function refresh_mychart(){
            var p1_width = $("#pannel_frame").width()-20;
            var p1_height = p1_width/4;
            $("#p1").width(p1_width).height(p1_height);
        }
    </script>
</block>